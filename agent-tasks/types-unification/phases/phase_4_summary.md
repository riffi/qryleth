# –§–∞–∑–∞ 4: –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—â–∏—Ö UI –∏ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ - –í–´–ü–û–õ–ù–ï–ù–û

## –û–±–∑–æ—Ä —Ñ–∞–∑—ã
**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 21 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~0.5 —á–∞—Å–∞  

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. ‚úÖ –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–∏–ø–æ–≤ –ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ñ–∞–∑
**–ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª**: –û—Å–Ω–æ–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è UI –∏ Database —Ç–∏–ø–æ–≤ —É–∂–µ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ –§–∞–∑–∞—Ö 2 –∏ 3:

- ‚úÖ **UI —Ç–∏–ø—ã** —É–∂–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `shared/types/ui/` (–§–∞–∑–∞ 2)
- ‚úÖ **Database —Ç–∏–ø—ã** —É–∂–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `shared/api/` (–§–∞–∑–∞ 2) 
- ‚úÖ **Store —Ç–∏–ø—ã** —É–∂–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `features/scene/model/` (–§–∞–∑–∞ 3)
- ‚úÖ **Hook return types** —É–∂–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `features/scene/model/view-types` (–§–∞–∑–∞ 3)

### 2. ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ import path consistency
**–ó–∞–¥–∞—á–∞**: –ó–∞–º–µ–Ω–∏—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –¥–ª—è –ª—É—á—à–µ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

#### **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ shared/r3f/primitives/**:
1. **PrimitiveRenderer.tsx** - —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –§–∞–∑–µ 3
2. **Box3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`
3. **Sphere3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`  
4. **Cylinder3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`
5. **Cone3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`
6. **Pyramid3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`
7. **Plane3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`
8. **Primitive3D.tsx** - `../../../entities/primitive` ‚Üí `@/entities/primitive`

#### **–û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª shared/r3f/optimization/**:
- **InstancedObjects.tsx**:
  ```typescript
  // –ë–´–õ–û:
  import type {SceneObjectInstance} from "../../../entities/scene/types.ts"
  import { ... } from '../../../features/scene/store/optimizedSelectors.ts'
  
  // –°–¢–ê–õ–û:
  import type { SceneObjectInstance } from '@/entities/scene/types'
  import { ... } from '@/features/scene/store/optimizedSelectors'
  ```

### 3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü
**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ**: –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ç–µ–ø–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º FSD:

- ‚úÖ **shared** —Å–ª–æ–π –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ `entities` (–¥–æ–ø—É—Å—Ç–∏–º–æ)
- ‚úÖ **features** —Å–ª–æ–π –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ `entities` –∏ `shared` (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- ‚úÖ **entities** —Å–ª–æ–π —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- ‚úÖ –ù–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–π –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Å–ª–æ–µ–≤

### 4. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: `npx tsc --noEmit` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ - –≤—Å–µ —Ç–∏–ø—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è

## –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ—Å—Ç—å**
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—Å–µ—Ö 4 —Ñ–∞–∑ —Å–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é FSD-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∏–ø–æ–≤:

```
‚úÖ shared/types/core/        - –ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ç–∏–ø—ã (Vector3, Transform)
‚úÖ shared/types/ui/          - –û–±—â–∏–µ UI —Ç–∏–ø—ã (ViewMode, Selection, Events) 
‚úÖ shared/api/               - API –∏ Database —Ç–∏–ø—ã
‚úÖ shared/lib/r3f/           - R3F —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã
‚úÖ features/scene/model/     - Scene-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã (Store, View)
‚úÖ entities/                 - –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (GfxPrimitive, etc.)
```

### üì¶ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–æ–≤**
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ (`@/entities`, `@/shared`, `@/features`)
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ (`../../../`)
- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å import statements

### üîÑ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- ‚úÖ TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–ª–∏–∞—Å—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ù–µ—Ç breaking changes –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### **–§–∞–∑—ã 1-4: –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å**
- **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ**: 11 (–Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∏–ø–æ–≤)
- **–§–∞–π–ª–æ–≤ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ**: 20+ —Ñ–∞–π–ª–æ–≤ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ
- **TypeScript –æ—à–∏–±–æ–∫**: 0

### **–§–∞–∑–∞ 4: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞**
- **Primitive —Ñ–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ**: 8 —Ñ–∞–π–ª–æ–≤
- **Optimization —Ñ–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ**: 1 —Ñ–∞–π–ª
- **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π –∑–∞–º–µ–Ω–µ–Ω–æ**: 10+ –∏–º–ø–æ—Ä—Ç–æ–≤
- **–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏**: –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### **–î–æ –≤—Å–µ—Ö —Ñ–∞–∑** (–ø—Ä–æ–±–ª–µ–º—ã):
```
‚ùå entities/r3f/types.ts (187 —Å—Ç—Ä–æ–∫) - –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª —Å mix of concerns
‚ùå –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏: ../../../entities/primitive  
‚ùå –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è: shared ‚Üí entities
‚ùå Store types –≤ entities –≤–º–µ—Å—Ç–æ features
```

### **–ü–æ—Å–ª–µ –§–∞–∑—ã 4** (–∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):
```
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø–æ FSD —Å–ª–æ—è–º
‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏: @/entities/primitive
‚úÖ –ù–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π
‚úÖ Store types –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º features —Å–ª–æ–µ
‚úÖ UI types –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º —Å–ª–æ—è–º –∏–∑ shared
```

## –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–∑

### **–ì–æ—Ç–æ–≤–æ –∫ –§–∞–∑–µ 5**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
–§–∞–∑–∞ 4 –∑–∞–≤–µ—Ä—à–∏–ª–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:

1. ‚úÖ **–í—Å–µ —Ç–∏–ø—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ FSD —Å–æ–±–ª—é–¥–µ–Ω–∞
2. ‚úÖ **–ò–º–ø–æ—Ä—Ç—ã –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã** - –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –≤–µ–∑–¥–µ
3. ‚úÖ **TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è** - –±–µ–∑ –æ—à–∏–±–æ–∫
4. üîÑ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–ª–∏–∞—Å—ã –≥–æ—Ç–æ–≤—ã** - –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –≤ –§–∞–∑–µ 5

### **–ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –¥–ª—è –§–∞–∑—ã 5**:
- –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ `entities/r3f/types-aliases.ts`
- –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ `entities/r3f/types.ts`  
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∞–ª–∏–∞—Å–æ–≤ –∏ –∏—Ö –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
- TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**  
- –í—Å–µ —Ç–∏–ø—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã —Å–æ–≥–ª–∞—Å–Ω–æ FSD –ø—Ä–∏–Ω—Ü–∏–ø–∞–º
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ import paths
- –ù–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π –≥—Ä–∞–Ω–∏—Ü —Å–ª–æ–µ–≤

### ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**
- –ß–∏—Ç–∞–µ–º—ã–µ –∏ maintainable –∏–º–ø–æ—Ä—Ç—ã
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–¥–∞
- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ cleanup

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

**–ì–æ—Ç–æ–≤—ã –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –§–∞–∑—ã 5**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

–§–∞–∑–∞ 4 –∑–∞–≤–µ—Ä—à–∏–ª–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é —Ç–∏–ø–æ–≤. –¢–µ–ø–µ—Ä—å –≤—Å–µ —Ç–∏–ø—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö —Å–æ–≥–ª–∞—Å–Ω–æ Feature-Sliced Design, –∏–º–ø–æ—Ä—Ç—ã –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã, –∏ —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–µ –æ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–∏–∞—Å–æ–≤.