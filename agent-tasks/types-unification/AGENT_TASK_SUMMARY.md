# –ê–≥–µ–Ω—Ç—Å–∫–∞—è –∑–∞–¥–∞—á–∞: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

> ‚ö†Ô∏è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≤–µ—Ä—è—Ç—å—Å—è —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∏–∑ [../../docs/AGENT_TASKS.md](../../docs/AGENT_TASKS.md) –∏ [../../docs/qryleth_architecture_guidelines.md](../../docs/qryleth_architecture_guidelines.md)

## –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–∫–∏–¥–∞–Ω—ã –ø–æ –∫–æ–¥—É —Ö–∞–æ—Ç–∏—á–Ω–æ: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–µ–∂–∞—Ç –≤ `/entities/[–Ω–∞–∑–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏]`, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ª–µ–∂–∞—Ç –≥—Ä—É–ø–ø–æ–π –≤ —Ñ–∞–π–ª–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, `entities/r3f/types`, `entities/scene/types` –∏ `/shared/lib/database`. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

#### –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤
1. **üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è**: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª `entities/r3f/types.ts` (187 —Å—Ç—Ä–æ–∫) —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã:
   - Store –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ features)
   - Hook return types (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ features/shared)  
   - UI state —Ç–∏–ø—ã –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã —Å domain entities
   - R3F-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã —Å–º–µ—à–∞–Ω—ã —Å –≥–µ–Ω–µ—Ä–∏–∫ scene —Ç–∏–ø–∞–º–∏

2. **üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è**: –ù–∞—Ä—É—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤:
   - `/entities/r3f/` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥–æ–º–µ–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç—å—é (–Ω–∞—Ä—É—à–µ–Ω–∏–µ FSD)
   - Store —Ç–∏–ø—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ entities –≤–º–µ—Å—Ç–æ features
   - Database —Ç–∏–ø—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç –∏–∑ entities (–Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ FSD)

3. **‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–∞—Ä–µ–ª—å–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤

#### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∏–ø–æ–≤

**‚úÖ –•–æ—Ä–æ—à–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ:**
- Domain entities: `/entities/{primitive,object,layer,objectInstance,lighting}/model/types.ts`
- Utility types: `/shared/types/{vector3,transform}.ts`  
- API types: `/shared/lib/{database,openAISettings,openAIAPI}.ts`

**‚ùå –¢—Ä–µ–±—É—é—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
- **–ú–æ–Ω–æ–ª–∏—Ç**: `/entities/r3f/types.ts` (187 —Å—Ç—Ä–æ–∫) - mix of store, UI, events
- **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã–µ**: Store types –≤ entities –≤–º–µ—Å—Ç–æ features
- **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –í–∑–∞–∏–º–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –º–µ–∂–¥—É entities –∏ shared

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
–°–æ–≥–ª–∞—Å–Ω–æ `qryleth_architecture_guidelines.md`:
- **–ü—Ä–∞–≤–∏–ª–æ –¥–æ—Å—Ç—É–ø–∞ —Å–ª–æ–µ–≤**: –∏–º–ø–æ—Ä—Ç —Ç–æ–ª—å–∫–æ "–≤–Ω–∏–∑" –∏–ª–∏ –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ
- **entities**: –¢–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã, –∞–ª–≥–æ—Ä–∏—Ç–º—ã, —Å—Ö–µ–º—ã (–Ω–µ React, –Ω–µ stores)
- **shared**: UI –∞—Ç–æ–º—ã, –æ–±—â–∏–µ —Ö—É–∫–∏/—É—Ç–∏–ª–∏—Ç—ã (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: entities)
- **features**: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, slice-store, UI –º–æ–ª–µ–∫—É–ª—ã (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: entities, shared)
- **–ë–∞—Ä–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å index.ts –¥–ª—è —á–∏—Å—Ç—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤

## –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —Ñ–∞–∑–∞–º

### –§–∞–∑–∞ 1: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
**–ó–∞–¥–∞—á–∞**: –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∏ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

**–§–∞–π–ª—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã**: –í—Å–µ TypeScript —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞, —Ñ–æ–∫—É—Å –Ω–∞ entities/r3f/types.ts

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑**:
1. **Mapping usage**: ‚úÖ –ù–∞–π–¥–µ–Ω—ã –≤—Å–µ 12 —Ñ–∞–π–ª–æ–≤, –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—â–∏—Ö –∏–∑ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
2. **Dependency graph**: ‚úÖ –ü–æ—Å—Ç—Ä–æ–µ–Ω –≥—Ä–∞—Ñ - —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ù–ï–¢ (—Ö–æ—Ä–æ—à–æ!)  
3. **Migration plan**: ‚úÖ –°–æ–∑–¥–∞–Ω –ø–ª–∞–Ω –ø–æ—ç—Ç–∞–ø–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–ª–µ–≥–∫–æ‚Üí—Å—Ä–µ–¥–Ω–µ‚Üí—Å–ª–æ–∂–Ω–æ)
4. **Breaking changes assessment**: ‚úÖ –í—ã—è–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–∏–∞—Å–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏**:
- **üö® –ö–†–ò–¢–ò–ß–ù–û**: 1 –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (PrimitiveRenderer.tsx –≤ shared –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ entities)
- **üìä 187 —Å—Ç—Ä–æ–∫** –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç 12 –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
- **üéØ –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏**: –õ–µ–≥–∫–∏–µ —Ç–∏–ø—ã (5 —Ñ–∞–π–ª–æ–≤) ‚Üí UI —Ç–∏–ø—ã (4 —Ñ–∞–π–ª–∞) ‚Üí Store —Ç–∏–ø—ã (1 —Ñ–∞–π–ª)
- **üõ°Ô∏è –ë–µ–∑ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –º–∏–≥—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–π

**–°–æ–∑–¥–∞–Ω—ã deliverables**:
- [–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º](phases/phase_1_summary.md)
- –ü–ª–∞–Ω –ø–æ—ç—Ç–∞–ø–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —Å –æ—Ü–µ–Ω–∫–æ–π —Ä–∏—Å–∫–æ–≤
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–∏–∞—Å–æ–≤ –¥–ª—è smooth transition

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ **–ü–ª–∞–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤** - –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –§–∞–∑—É 2

### –§–∞–∑–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∏–ø–æ–≤ ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ  
**–ó–∞–¥–∞—á–∞**: –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é FSD-—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ç–∏–ø–æ–≤ –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

**–°–æ–∑–¥–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```
‚úÖ /shared/
  ‚úÖ /types/
    ‚úÖ /core/          - index.ts (Vector3, Transform + –±—É–¥—É—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã)
    ‚úÖ /ui/            - index.ts, events.ts (ViewMode, Selection, Events)
    ‚úÖ index.ts        - –≥–ª–∞–≤–Ω—ã–π barrel export
  ‚úÖ /api/             - types.ts (Database records, API types)
  ‚úÖ /lib/r3f/         - types.ts (R3F —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã)
‚úÖ /entities/
  ‚úÖ index.ts          - —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö entities
‚úÖ /features/scene/model/
  ‚úÖ index.ts          - barrel export
  ‚úÖ store-types.ts    - SceneStore, SceneStoreState, SceneStoreActions
  ‚úÖ view-types.ts     - Hook return types, UI —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã
```

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏**:
1. ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞**: 11 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π FSD –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π
2. ‚úÖ **–¢–∏–ø—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã**: –í—Å–µ —Ç–∏–ø—ã –∏–∑ entities/r3f/types.ts —Ä–∞–∑–º–µ—â–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. ‚úÖ **Barrel exports**: 6 index.ts —Ñ–∞–π–ª–æ–≤ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
4. ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–ª–∏–∞—Å—ã –≤ entities/r3f/types-aliases.ts

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
- üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞ - —Å–æ–±–ª—é–¥–µ–Ω—ã –ø—Ä–∏–Ω—Ü–∏–ø—ã FSD
- üì¶ –£–¥–æ–±—Å—Ç–≤–æ - barrel exports –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π  
- üîÑ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –Ω–µ—Ç breaking changes, –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- üìä 11 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ **FSD-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞** - –≥–æ—Ç–æ–≤—ã –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ –§–∞–∑–µ 3

### –§–∞–∑–∞ 3: –ú–∏–≥—Ä–∞—Ü–∏—è Store –∏ Feature —Ç–∏–ø–æ–≤ ‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
**–ó–∞–¥–∞—á–∞**: –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å–µ store –∏ feature-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã –∏–∑ entities –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ features

**–§–∞–π–ª—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏**:
- `/entities/r3f/types.ts` ‚Üí `/features/scene/model/` (—Ç–∏–ø—ã stores)
- Store interfaces ‚Üí —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ features
- Hook return types ‚Üí features/shared

**–¢–∏–ø—ã –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è**:
```typescript
// –ò–∑ entities/r3f/types.ts –≤ features/scene/model/store-types.ts:
- SceneStoreState, SceneStoreActions, SceneStore
- UseSceneEventsReturn, UseObjectSelectionReturn, etc.

// –ò–∑ entities/r3f/types.ts –≤ features/scene/model/view-types.ts:  
- ViewMode, RenderMode, TransformMode
- SelectedObject, HoveredObject
- SceneMetaData, SceneStatus

// –ò–∑ entities/r3f/types.ts –≤ shared/types/ui/events.ts:
- SceneClickEvent, SceneHoverEvent
- ObjectTransformEvent, PrimitiveTransformEvent
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏**:
1. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–ª–∏–∞—Å—ã** –≤ —Å—Ç–∞—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö: `export type { SceneStore } from '@/features/scene/model'`
3. **–û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã** –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤ –Ω–µ–±–æ–ª—å—à–∏—Ö –±–∞—Ç—á–∞—Ö
4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —á–µ—Ä–µ–∑ re-exports

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- –í—Å–µ store —Ç–∏–ø—ã –≤ features —Å–ª–æ–µ  
- –ù–µ—Ç —Ç–∏–ø–æ–≤ –≤ entities/r3f/
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: Store –∏ feature —Ç–∏–ø—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ features —Å–ª–æ–µ

### –§–∞–∑–∞ 4: –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—â–∏—Ö UI –∏ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ ‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
**–ó–∞–¥–∞—á–∞**: –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ UI —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –≤ shared —Å–ª–æ–π —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π

**–§–∞–π–ª—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏**:
- UI —Ç–∏–ø—ã ‚Üí `/shared/types/ui/`
- R3F —Ç–∏–ø—ã ‚Üí `/shared/lib/r3f/`  
- Database —Ç–∏–ø—ã ‚Üí `/shared/api/`

**–î–µ—Ç–∞–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏**:
1. **–û–±—â–∏–µ UI —Ç–∏–ø—ã –≤ shared/types/ui/**:
   ```typescript
   // ViewMode, RenderMode - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö features
   // Selection —Ç–∏–ø—ã - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –¥–ª—è UI
   // Event —Ç–∏–ø—ã - –∫—Ä–æ—Å—Å—Ñ–∏—á–µ–≤—ã–µ
   ```

2. **R3F —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–∏–ø—ã –≤ shared/lib/r3f/**:
   ```typescript  
   // R3F-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã (Three.js integrations)
   // Canvas, Scene technical types
   // Renderer configuration types
   ```

3. **API —Ç–∏–ø—ã –≤ shared/api/**:
   ```typescript
   // Database record types
   // Network/API interfaces  
   // External service types
   ```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏**:
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. –î–æ–±–∞–≤–∏—Ç—å –±–∞—Ä–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã  
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –±–∞—Ç—á–∞–º–∏ (–ø–æ 10-15 —Ñ–∞–π–ª–æ–≤)
4. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç–∏–ø—ã –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ –æ–±—â–∏–µ —Ç–∏–ø—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ shared —Å–ª–æ–µ

### –§–∞–∑–∞ 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ ‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ  
**–ó–∞–¥–∞—á–∞**: –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –Ω–∞ –Ω–æ–≤—ã–µ –ø—É—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –í—Å–µ TypeScript —Ñ–∞–π–ª—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏ —Ç–∏–ø–æ–≤

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤**:
1. **Batch updates**: –û–±–Ω–æ–≤–ª—è—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ feature/domain
2. **Automated scripts**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å find-replace —Å validation
3. **Test-driven**: –ü—Ä–æ–≥–æ–Ω—è—Ç—å —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ batch'–∞
4. **Standardized paths**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã

**–¶–µ–ª–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–º–ø–æ—Ä—Ç–æ–≤**:
```typescript
// Domain entities
import type { GfxPrimitive, GfxObject } from '@/entities'

// Core utilities  
import type { Vector3, Transform } from '@/shared/types/core'

// UI types
import type { ViewMode, SelectionState } from '@/shared/types/ui'

// Feature types
import type { SceneStore } from '@/features/scene/model'

// API types
import type { SceneRecord, ObjectRecord } from '@/shared/api'
```

**–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**:
1. –£–¥–∞–ª–∏—Ç—å `/entities/r3f/` –ø–æ–ª–Ω–æ—Å—Ç—å—é
2. –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ñ–∞–π–ª—ã —Ç–∏–ø–æ–≤
3. –£–¥–∞–ª–∏—Ç—å re-export –∞–ª–∏–∞—Å—ã
4. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ index.ts —Ñ–∞–π–ª—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**:
- –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–µ –ø—É—Ç–∏
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –ß–∏—Å—Ç–∞—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤

### –§–∞–∑–∞ 6: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞—Ä–µ–ª—å–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
**–ó–∞–¥–∞—á–∞**: –°–æ–∑–¥–∞—Ç—å —É–¥–æ–±–Ω—É—é —Å–∏—Å—Ç–µ–º—É —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ç–∏–ø–æ–≤

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**:
- –í—Å–µ `index.ts` —Ñ–∞–π–ª—ã –≤ type-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- `spec/TYPES_GUIDE.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–∏–ø–∞–º
- –û–±–Ω–æ–≤–∏—Ç—å imports –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–ë–∞—Ä–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã –ø–æ —É—Ä–æ–≤–Ω—è–º**:
```typescript
// /shared/types/index.ts - –∫–æ—Ä–Ω–µ–≤–æ–π —ç–∫—Å–ø–æ—Ä—Ç shared —Ç–∏–ø–æ–≤
export * from './core'
export * from './ui'

// /shared/api/index.ts - API types
export * from './types'
export * from './database' 

// /entities/index.ts - –≤—Å–µ domain entities
export * from './primitive'
export * from './object'
export * from './layer'
export * from './scene'

// /features/scene/model/index.ts - scene feature types
export * from './store-types'
export * from './view-types'
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**:
–í –ø–∞–ø–∫–µ /spec
1. **TYPES_GUIDE.md**: –ì–¥–µ –Ω–∞–π—Ç–∏ –∫–∞–∫–∏–µ —Ç–∏–ø—ã
2. **Import examples**: –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
3. **Architecture rationale**: –ü–æ—á–µ–º—É —Ç–∏–ø—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã –∏–º–µ–Ω–Ω–æ —Ç–∞–∫
4. **Migration guide**: –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–¥ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ç–∏–ø–æ–≤

**TypeScript configuration**:
- –û–±–Ω–æ–≤–∏—Ç—å `paths` –≤ tsconfig.json –¥–ª—è —É–¥–æ–±–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å type-only imports –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –î–æ–±–∞–≤–∏—Ç—å lint rules –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–æ–≤

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –£–¥–æ–±–Ω–∞—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤

## –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–∞–∑
- [x] **–§–∞–∑–∞ 1**: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ - ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
- [x] **–§–∞–∑–∞ 2**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∏–ø–æ–≤ - ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
- [ ] **–§–∞–∑–∞ 3**: –ú–∏–≥—Ä–∞—Ü–∏—è Store –∏ Feature —Ç–∏–ø–æ–≤ - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
- [ ] **–§–∞–∑–∞ 4**: –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—â–∏—Ö UI –∏ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
- [ ] **–§–∞–∑–∞ 5**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
- [ ] **–§–∞–∑–∞ 6**: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞—Ä–µ–ª—å–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ

## –°—Å—ã–ª–∫–∏ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–∑—ã
- [–§–∞–∑–∞ 1: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π](phases/phase_1_summary.md) - ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
- [–§–∞–∑–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∏–ø–æ–≤](phases/phase_2_summary.md) - ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –∏ –º–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏

### üö® Breaking Changes Risks
1. **Store types migration**: –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ features
   - **–ú–∏—Çigation**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–∏–∞—Å—ã –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é
2. **Circular dependencies**: –ü—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ —Ç–∏–ø–æ–≤
   - **–ú–∏—Çigation**: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –§–∞–∑–µ 1
3. **Build failures**: TypeScript compilation errors
   - **–ú–∏—Çigation**: Batch updates —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ batch'–∞

### üõ°Ô∏è Safety Measures  
1. **Gradual migration**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç–∏–ø—ã –¥–æ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
2. **Re-exports**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∞–ª–∏–∞—Å—ã
3. **Test coverage**: –ü—Ä–æ–≥–æ–Ω—è—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
4. **Rollback plan**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞**: –°—Ç—Ä–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å FSD –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –∏–∑ guidelines
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ - —Ç–æ–ª—å–∫–æ —É–ª—É—á—à–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã —É–±–µ–∂–¥–∞—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û–±–Ω–æ–≤–ª—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—É–±–ª–∏—á–Ω—ã—Ö API

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
- **entities**: –¢–æ–ª—å–∫–æ business domain —Ç–∏–ø—ã (GfxPrimitive, GfxObject, etc.)
- **shared**: –û–±—â–∏–µ —Ç–∏–ø—ã, –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º features  
- **features**: Feature-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã (stores, business logic)
- **–ò–º–ø–æ—Ä—Ç—ã**: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã (`import type`)
- **–ë–∞—Ä–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã**: –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç—å –∏–º–ø–æ—Ä—Ç –∏–∑ index.ts —Ñ–∞–π–ª–æ–≤
