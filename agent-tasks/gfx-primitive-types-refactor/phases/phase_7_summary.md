# Фаза 7: Обновление хранилищ и API

## Обязательная ссылка на инструкции
При выполнении данной фазы агент сверялся с требованиями в [agent-tasks.md](../../../docs/development/workflows/agent-tasks.md)

## Изменённые файлы
- `src/entities/primitive/model/normalize.ts`
- `src/features/scene/lib/correction/LLMGeneratedObjectCorrector.ts`

## Описание выполненной работы
- Реализована поддержка устаревшего формата примитивов в `normalizePrimitive`. Теперь функция преобразует старые поля (width, height и т.д.) в новую структуру `geometry`, а также переносит материал и трансформации в соответствующие вложенные объекты.
- Добавлена дополнительная нормализация цилиндров в новом формате, если указано только поле `radius`.
- Файл `LLMGeneratedObjectCorrector.ts` обновлён для работы с полями `geometry` и `transform`. Все вычисления выполняются на основе новой структуры данных.

## Статус проекта после фазы
- ✅ Загрузка старых данных корректно конвертируется в новый формат.
- ✅ Корректор объектов учитывает новую схему типов.
- ✅ Проект компилируется.

## Новый контекст для будущих фаз
- Данные из старых сцен теперь автоматически преобразуются при загрузке.
- Алгоритмы коррекции расположения примитивов используют `primitive.transform` и `primitive.geometry`.

## Статус
**Выполнено** ✅

Дата выполнения: 2025-07-28
