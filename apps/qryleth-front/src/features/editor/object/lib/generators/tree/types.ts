/**
 * Параметры процедурной генерации дерева.
 * На основе этих значений генератор строит набор примитивов ствола/ветвей/листвы
 * и возвращает их для добавления в редактируемый объект.
 */
export interface TreeGeneratorParams {
  /** Сид случайности для детерминированной генерации */
  seed: number
  /** Общая высота ствола (в единицах сцены) */
  trunkHeight: number
  /** Радиус ствола у основания */
  trunkRadius: number
  /** Количество сегментов ствола (вертикальная детализация) */
  trunkSegments: number
  /**
   * Коэффициент сужения ствола к верху (0..1).
   * 0 — без сужения; 1 — радиус к верху стремится к нулю.
   * Рекомендуемые значения 0.2..0.6. По умолчанию 0.4.
   */
  trunkTaperFactor?: number
  /** Количество уровней ветвления (0 — без ветвей) */
  branchLevels: number
  /** Количество ветвей на сегмент ствола (усреднённо) */
  branchesPerSegment: number
  /**
   * Привязка ветвей к верхней части дерева (0..1).
   * 0 — ветви формируются равномерно вдоль высоты,
   * 1 — ветви концентрируются у верхних сегментов (внизу почти нет ветвей).
   */
  branchTopBias?: number

  /**
   * Стремление ветвей «смотреть вверх» (0..1).
   * 0 — без предпочтения (как сейчас), 1 — направления с отрицательной Y‑составляющей
   * сильно штрафуются при выборе кандидата (ветка ориентируется вверх).
   */
  branchUpBias?: number
  /** Длина ветви базовая (умножается на коэффициенты по уровням) */
  branchLength: number
  /**
   * Разброс длины ветви (0..1). Если не задан — используется значение `randomness`.
   * 0 — без разброса; 1 — примерно ±30% от базовой длины.
   */
  branchLengthJitter?: number
  /** Радиус ветви на первом уровне (тоньше на следующих уровнях) */
  branchRadius: number
  /** Угол наклона ветви от вертикали, в градусах */
  branchAngleDeg: number
  /**
   * Переопределение угла для уровня 1 (если задано). Если не задан — используется branchAngleDeg.
   */
  branchAngleDegFirst?: number
  /**
   * Переопределение угла для уровней ≥2 (если задано). Если не задан — используется branchAngleDeg.
   */
  branchAngleDegNext?: number
  /** Доля случайного разброса параметров (0..1) */
  randomness: number
  /** Количество листьев на конце каждой ветви (на верхнем уровне) */
  leavesPerBranch: number
  /** Размер (радиус) листа, если рендерим лист как сферу */
  leafSize: number
  /** Тип листвы: billboard или sphere */
  leafShape?: 'billboard' | 'sphere' | 'coniferCross'
  /**
   * Схема размещения листвы: только на концах ветвей ('end') или вдоль ветви ('along').
   */
  leafPlacement?: 'end' | 'along'
  /**
   * Плотность листвы вдоль ветви (кластеров на метр). Используется при leafPlacement='along'.
   */
  leavesPerMeter?: number
  /**
   * Разброс наклона ветви относительно вертикали (0..1).
   * Применяется к параметру `branchAngleDeg`: при 0 — без разброса (точно
   * `branchAngleDeg`), при 1 — максимальный джиттер наклона (порядка ±50%
   * от `branchAngleDeg`). На азимут не влияет: азимут выбирается случайно
   * равномерно в диапазоне [0..2π].
   */
  angleSpread?: number

  /**
   * Коэффициент заглубления ответвлений в родительскую ветку/ствол (0..1).
   * Глубина заглубления рассчитывается как min(parentRadius, branchRadius) * embedFactor
   * и используется, чтобы скрыть торцевую круглую грань цилиндра ветки внутри
   * родительского цилиндра. Значение по умолчанию: 0.6.
   */
  embedFactor?: number

  /**
   * Количество уровней разветвления самого ствола (0 — без разветвления ствола).
   * Каждый уровень создаёт ответвления-стволы меньшего радиуса с небольшим наклоном.
   * По умолчанию 0.
   */
  trunkBranchLevels?: number
  /**
   * Сколько стволов образуется на каждом уровне разветвления. По умолчанию 2.
   */
  trunkBranchesPerLevel?: number
  /**
   * Угол наклона ответвлений ствола от вертикали (в градусах). По умолчанию 20°.
   */
  trunkBranchAngleDeg?: number
  /**
   * Во сколько раз короче высота дочерних стволов относительно родителя (0..1). По умолчанию 0.7.
   */
  trunkBranchChildHeightFactor?: number
}

/**
 * Результат генерации дерева: примитивы и базовые материалы (без UUID).
 */
export interface TreeGeneratorResult {
  primitives: import('@/entities/primitive').GfxPrimitive[]
  materials: import('@/entities/material').CreateGfxMaterial[]
}
