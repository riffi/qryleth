/**
 * Доменные типы глобальной палитры цветов.
 *
 * Типы предназначены для переиспользования как материалами (источник базового цвета),
 * так и системами окраски террейна (стопы многоцветной палитры).
 */

/**
 * Роль цвета в палитре.
 * Каждая роль описывает назначение цвета для различных подсистем сцены.
 */
export type PaletteRole =
  | 'sky'
  | 'fog'
  | 'water'
  | 'foliage'
  | 'wood'
  | 'rock'
  | 'metal'
  | 'sand'
  | 'ground'
  | 'snow'
  | 'accent'

/**
 * Глобальная палитра: именованный набор цветов по ролям.
 */
export interface GlobalPalette {
  /** Уникальный идентификатор палитры (должен быть стабильным) */
  uuid: string
  /** Название палитры для отображения в UI */
  name: string
  /** Сопоставление роль → цвет (HEX, формат #rrggbb) */
  colors: Record<PaletteRole, string>
}

/**
 * Источник цвета для материалов и террейна.
 *
 * fixed — использовать «локальный» цвет, заданный свойством цветового поля (например, properties.color).
 * role  — взять базовый цвет из активной палитры по роли и опционально применить tint.
 */
export type ColorSource =
  | { type: 'fixed' }
  | {
      type: 'role'
      role: PaletteRole
      /**
       * Сдвиг яркости (Value, HSV) в диапазоне [-1..+1].
       * Положительные значения делают цвет ярче, отрицательные — темнее.
       */
      tint?: number
      /**
       * Интерполяция оттенка по кратчайшей дуге к целевому значению (градусы 0..360).
       * H = H(role) + t * shortestArc(H(role) → deg)
       * Где t ∈ [0..1]: 0 — без сдвига, 1 — точно в целевой оттенок.
       */
      hueTowards?: { deg: number; t: number }
      /**
       * Сдвиг насыщенности (Saturation, HSV) в диапазоне [-1..+1].
       * Положительные значения повышают насыщенность, отрицательные — приглушают.
       */
      saturationShift?: number
    }
